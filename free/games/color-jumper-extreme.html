<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Color Jumper Extreme</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
:root {
  --bg:#0f1220;
  --panel:#161a2b;
  --text:#e5e7eb;
  --marker:#ff4444;
  --jump:#3b82f6;
  --score:#fbbf24;
  --speed:#f472b6;
}
html,body {
  height:100%;
  margin:0;
  font-family:system-ui,Arial;
  background:radial-gradient(1200px 800px at 70% -10%, #1d2241 0%, var(--bg) 60%) no-repeat fixed;
  color:var(--text);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}
canvas {
  background:var(--bg);
  border:2px solid var(--panel);
  border-radius:16px;
  box-shadow:0 0 20px #000a;
  width:90vw;
  height:80vh;
  max-width:700px;
}
#ui {
  position:fixed;
  top:10px;
  width:100%;
  text-align:center;
  font-size:18px;
  color:var(--text);
  text-shadow:0 0 10px #000;
}
#ui span {margin:0 10px;}
button {
  margin-top:20px;
  background:var(--panel);
  border:none;
  color:var(--text);
  font-size:20px;
  padding:12px 30px;
  border-radius:12px;
  cursor:pointer;
  box-shadow:0 0 10px #000a;
  transition:transform 0.15s;
}
button:hover {transform:scale(1.05);}
button:active {transform:scale(0.95);}
@keyframes pulse {
  0%,100% {opacity:0.5; box-shadow:0 0 6px 2px var(--marker);}
  50% {opacity:1; box-shadow:0 0 14px 4px var(--marker);}
}
</style>
</head>
<body>
<div id="ui">
  <span id="scoreLabel">Score: 0</span>
  <span id="platformLabel">Platforms: 0</span>
  <span id="levelLabel">Level: 1</span>
</div>
<canvas id="game"></canvas>
<button id="startBtn">Play</button>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=400; canvas.height=600;

let player,platforms=[],keys={},running=false,score=0,platformCount=0,cameraY=0,markers=[],scorePopups=[];
let level=1;
const gravity=0.5,jumpPower=-10,playerSize=20,platformWidth=70,platformHeight=10;

function randomColor(){
  return "#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,"0");
}

function startGame(){
  running=true;
  score=0; platformCount=0; level=1; cameraY=0;
  player={x:canvas.width/2-10,y:canvas.height-60,vy:0,color:randomColor()};
  platforms=[];
  for(let i=0;i<120;i++){
    const x=Math.random()*(canvas.width-platformWidth);
    const y=canvas.height-i*60;
    platforms.push({x,y,color:"#38bdf8"});
  }
  markers=[];
  for(let i=50;i<=1000;i+=50){
    markers.push({platformIndex:i,color:"var(--marker)"});
  }
  scorePopups=[];
  document.getElementById("startBtn").style.display="none";
  loop();
}

function update(){
  player.vy+=gravity;
  player.y+=player.vy;
  if(keys.a)player.x-=4;
  if(keys.d)player.x+=4;

  // Platform collision
  for(let p of platforms){
    if(player.vy>0 &&
       player.x+playerSize>p.x && player.x<p.x+platformWidth &&
       player.y+playerSize>p.y && player.y+playerSize<p.y+platformHeight){
      player.vy=jumpPower;
      score+=10;
      platformCount++;
      scorePopups.push({x:player.x+playerSize/2,y:p.y-20-cameraY,alpha:1,text:"+10"});
      if(platformCount%50===0)level++;
    }
  }

  // Camera follow
  if(player.y<canvas.height/2) cameraY+=canvas.height/2 - player.y;
  if(player.x<0)player.x=0;
  if(player.x+playerSize>canvas.width)player.x=canvas.width-playerSize;

  // Update UI
  document.getElementById("scoreLabel").textContent="Score: "+score;
  document.getElementById("platformLabel").textContent="Platforms: "+platformCount;
  document.getElementById("levelLabel").textContent="Level: "+level;

  // Update score popups
  scorePopups.forEach(p=>{p.y-=1; p.alpha-=0.02;});
  scorePopups=scorePopups.filter(p=>p.alpha>0);
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Markers
  markers.forEach((m,i)=>{
    const idx=m.platformIndex-1;
    if(idx<platforms.length){
      const plat=platforms[idx];
      const y=plat.y-cameraY;
      ctx.strokeStyle=m.color;
      ctx.lineWidth=4;
      ctx.shadowColor=m.color;
      ctx.shadowBlur=10+5*Math.sin(Date.now()/300);
      ctx.beginPath();
      ctx.moveTo(0,y);
      ctx.lineTo(canvas.width,y);
      ctx.stroke();
      ctx.shadowBlur=0;
      ctx.fillStyle="var(--marker)";
      ctx.font="bold 18px Arial";
      ctx.fillText(`LEVEL ${i+1}`,10,y-10);
    }
  });

  // Platforms
  for(let p of platforms){
    ctx.fillStyle=p.color;
    ctx.fillRect(p.x,p.y-cameraY,platformWidth,platformHeight);
  }

  // Player
  ctx.fillStyle=player.color;
  ctx.fillRect(player.x,player.y-cameraY,playerSize,playerSize);

  // Floating score popups
  for(let s of scorePopups){
    ctx.globalAlpha=s.alpha;
    ctx.fillStyle="var(--score)";
    ctx.font="bold 16px Arial";
    ctx.fillText(s.text,s.x,s.y);
  }
  ctx.globalAlpha=1;
}

function loop(){
  if(!running)return;
  update();
  draw();
  requestAnimationFrame(loop);
}

document.addEventListener("keydown",e=>keys[e.key.toLowerCase()]=true);
document.addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);
document.getElementById("startBtn").onclick=startGame;
</script>
</body>
</html>
